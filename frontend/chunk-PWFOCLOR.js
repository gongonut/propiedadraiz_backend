import{b as N,c as u,d as D,e as T,g as A,j,l as k,p as q,q as G,s as O}from"./chunk-VIDUQQKM.js";import{a as L}from"./chunk-FBTTXVKJ.js";import{c as w,g as I}from"./chunk-JXAVADQN.js";import{$ as m,Ab as C,Bb as _,Jb as n,Kb as S,Pa as a,W as h,a as x,b,cb as y,hb as p,qb as d,rb as i,sb as e,tb as g,tc as E,wc as F}from"./chunk-O5M3UDUQ.js";var v=class t{http=m(w);apiUrl=`${L.apiUrl}/leads`;createLead(o){return this.http.post(this.apiUrl,o)}static \u0275fac=function(l){return new(l||t)};static \u0275prov=h({token:t,factory:t.\u0275fac,providedIn:"root"})};function R(t,o){t&1&&(i(0,"div",19),n(1," El nombre es requerido. "),e())}function U(t,o){t&1&&(i(0,"div",19),n(1," Un n\xFAmero v\xE1lido es requerido. "),e())}function H(t,o){t&1&&(i(0,"div",19),n(1," Ingresa un correo v\xE1lido. "),e())}function B(t,o){t&1&&(i(0,"span"),n(1,"Ver Inmueble"),e())}function P(t,o){t&1&&(i(0,"span"),n(1,"Enviando..."),e())}function W(t,o){t&1&&(i(0,"div",20)(1,"p",21),n(2,"\xA1Gracias!"),e(),i(3,"p",22),n(4,"Te hemos enviado la informaci\xF3n a tu WhatsApp."),e()())}function $(t,o){if(t&1&&(i(0,"div",23)(1,"p",22),n(2),e()()),t&2){let l=_();a(2),S(l.error)}}var M=class t{leadForm;loading=!1;submitted=!1;error="";propertyCode=null;fb=m(G);route=m(I);leadsService=m(v);constructor(){this.leadForm=this.fb.group({name:["",u.required],whatsapp:["",[u.required,u.pattern(/^\+?[0-9]{10,15}$/)]],email:["",[u.email]]})}ngOnInit(){this.propertyCode=this.route.snapshot.paramMap.get("code"),this.propertyCode||(this.error="C\xF3digo de propiedad no v\xE1lido.")}onSubmit(){if(this.leadForm.invalid||!this.propertyCode)return;this.loading=!0,this.error="";let o=b(x({},this.leadForm.value),{propertyCode:this.propertyCode});this.leadsService.createLead(o).subscribe({next:()=>{this.loading=!1,this.submitted=!0,this.leadForm.disable()},error:l=>{console.error(l),this.loading=!1,this.error="Hubo un error al procesar tu solicitud. Intenta nuevamente."}})}static \u0275fac=function(l){return new(l||t)};static \u0275cmp=y({type:t,selectors:[["app-lead-capture"]],decls:33,vars:9,consts:[[1,"min-h-screen","bg-gray-100","flex","flex-col","justify-center","py-12","sm:px-6","lg:px-8"],[1,"sm:mx-auto","sm:w-full","sm:max-w-md"],[1,"mt-6","text-center","text-3xl","font-extrabold","text-gray-900"],[1,"mt-2","text-center","text-sm","text-gray-600"],[1,"mt-8","sm:mx-auto","sm:w-full","sm:max-w-md"],[1,"bg-white","py-8","px-4","shadow","sm:rounded-lg","sm:px-10"],[1,"space-y-6",3,"ngSubmit","formGroup"],["for","name",1,"block","text-sm","font-medium","text-gray-700"],[1,"mt-1"],["id","name","type","text","formControlName","name","required","",1,"appearance-none","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","placeholder-gray-400","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm"],["class","text-red-500 text-xs mt-1",4,"ngIf"],["for","whatsapp",1,"block","text-sm","font-medium","text-gray-700"],["id","whatsapp","type","tel","formControlName","whatsapp","required","","placeholder","Ej: +573001234567",1,"appearance-none","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","placeholder-gray-400","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm"],["for","email",1,"block","text-sm","font-medium","text-gray-700"],["id","email","type","email","formControlName","email",1,"appearance-none","block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","placeholder-gray-400","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm"],["type","submit",1,"w-full","flex","justify-center","py-2","px-4","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500","disabled:opacity-50",3,"disabled"],[4,"ngIf"],["class","mt-4 p-4 rounded-md bg-green-50 text-green-700 text-center",4,"ngIf"],["class","mt-4 p-4 rounded-md bg-red-50 text-red-700 text-center",4,"ngIf"],[1,"text-red-500","text-xs","mt-1"],[1,"mt-4","p-4","rounded-md","bg-green-50","text-green-700","text-center"],[1,"font-medium"],[1,"text-sm"],[1,"mt-4","p-4","rounded-md","bg-red-50","text-red-700","text-center"]],template:function(l,r){if(l&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2),n(3," \xA1Hola! \u{1F44B} "),e(),i(4,"p",3),n(5," Para ver la informaci\xF3n detallada del inmueble, por favor completa tus datos. "),e()(),i(6,"div",4)(7,"div",5)(8,"form",6),C("ngSubmit",function(){return r.onSubmit()}),i(9,"div")(10,"label",7),n(11," Nombre Completo "),e(),i(12,"div",8),g(13,"input",9),e(),p(14,R,2,0,"div",10),e(),i(15,"div")(16,"label",11),n(17," N\xFAmero de WhatsApp "),e(),i(18,"div",8),g(19,"input",12),e(),p(20,U,2,0,"div",10),e(),i(21,"div")(22,"label",13),n(23," Correo Electr\xF3nico (Opcional) "),e(),i(24,"div",8),g(25,"input",14),e(),p(26,H,2,0,"div",10),e(),i(27,"div")(28,"button",15),p(29,B,2,0,"span",16)(30,P,2,0,"span",16),e()()(),p(31,W,5,0,"div",17)(32,$,3,1,"div",18),e()()()),l&2){let s,c,f;a(8),d("formGroup",r.leadForm),a(6),d("ngIf",((s=r.leadForm.get("name"))==null?null:s.touched)&&((s=r.leadForm.get("name"))==null?null:s.invalid)),a(6),d("ngIf",((c=r.leadForm.get("whatsapp"))==null?null:c.touched)&&((c=r.leadForm.get("whatsapp"))==null?null:c.invalid)),a(6),d("ngIf",((f=r.leadForm.get("email"))==null?null:f.touched)&&((f=r.leadForm.get("email"))==null?null:f.invalid)),a(2),d("disabled",r.leadForm.invalid||r.loading),a(),d("ngIf",!r.loading),a(),d("ngIf",r.loading),a(),d("ngIf",r.submitted),a(),d("ngIf",r.error)}},dependencies:[F,E,O,A,N,D,T,q,j,k],encapsulation:2})};export{M as LeadCaptureComponent};
